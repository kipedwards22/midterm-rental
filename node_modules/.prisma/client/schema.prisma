generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Host {
  id                 String    @id @default(uuid())
  email              String    @unique
  passwordHash       String
  name               String
  guestyAccountId    String?
  guestyAccessToken  String?
  guestyRefreshToken String?
  guestyTokenExpiry  DateTime?
  listings           Listing[]
  createdAt          DateTime  @default(now())
}

model Listing {
  id            String        @id @default(uuid())
  hostId        String
  host          Host          @relation(fields: [hostId], references: [id])
  guestyId      String        @unique
  title         String
  description   String?
  street        String?
  city          String?
  state         String?
  zip           String?
  lat           Float?
  lng           Float?
  bedrooms      Int?
  bathrooms     Float?
  maxGuests     Int?
  basePrice     Float?
  minStayNights Int?
  amenities     String[]
  photos        Json?
  status        String        @default("active")
  lastSyncedAt  DateTime?
  calendarDays  CalendarDay[]
  createdAt     DateTime      @default(now())
}

model CalendarDay {
  id        String   @id @default(uuid())
  listingId String
  listing   Listing  @relation(fields: [listingId], references: [id])
  date      DateTime
  available Boolean
  price     Float?
  minStay   Int?

  @@unique([listingId, date])
}
